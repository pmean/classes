---
title: "05-03, The analysis of variance table"
format: 
  revealjs:
    slide-number: true
    embed-resources: true
editor: source
---

```{r setup-3}
#| message: false
#| warning: false
library(broom)
library(tidyverse)
load("../data/module05.RData")
```


## Sum of squares regression

```{r}
yhat <- 30-simple$x
draw_line(20, 0, pts=yhat)
```

## Sum of squares error

```{r}
draw_line(30, -1)

```

## Sum of squares total / corrected total

```{r}
draw_line(20, 0)
```

## Sum of squares total (uncorrected)

```{r}
draw_line(0, 0, pts=simple$y)
```

## ANOVA table for linear regression

```{=tex}
\begin{matrix}
            &  SS &  df &                  MS &           F-ratio \\
 Regression & SSR &   1 &   MSR=\frac{SSR}{1} & F=\frac{MSR}{MSE} \\
 Error      & SSE & n-2 & MSE=\frac{SSE}{n-2} &                   \\
 Total      & SST & n-1 &                     &
\end{matrix}
```

## Analysis of variance table in R

```{r anova}
anova(m1)
```

## R-squared

-   SST, total variation, is split into
    -    SSR, explained variation, and
    -    SSE, unexplained variation
-   $R^2=\frac{SSR}{SST}=1-\frac{SSE}{SST}$
    -    $0 < R^2 < 1$
    -    Proportion of explained variation

## R-squared calculation in R

```{r r-squared}
glance(m1)$r.squared
```

## Confidence intervals, 1

-   Population model
    -   $Y_i=\beta_0+\beta_1 X_i + \epsilon_i,\ i=1,...,N$
-   Sample estimates
    -   $b_1=\frac{\Sigma(X_i-\bar{X})(Y_i-]bar{Y)}{\Sigma(X_i-\bar{X})^2}$
    -   $b_0=\bar{Y}-b_1\bar{X}$
   
## Confidence intervals, 2

-   Standard error (se)
    -   $se(b_1)=\sqrt{\frac{MSE}{(n-1)*S_x^2}}$
-   Confidence interval for $\beta_1$
    -   $b_1 \pm t se(b_1)$
    
## Confidence intervals, 3

```{r confidence-interval}
confint(m1)
```

## Hypothesis test, 1

-   $H_0:\ \beta_1=0$
-   $H_1:\ \beta_1 \ne 0$
    -   Reject $H_0$ if $T=\frac{b_1}{se(b_1)} is close to zero$