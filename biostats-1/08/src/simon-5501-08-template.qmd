---
title: "Template for 5501-08 programming assignment"
author: "Steve Simon"
format: 
  html:
    embed-resources: true
date: 2024-08-18
---

This program reads data in a "wide" format, restructures it, and runs a two-sample t-test. Consult the [data dictionary][dic] for information about the data itself.

[dic]: https://github.com/pmean/data/blob/main/files/gingko-memory.yaml

## Libraries

```{r setup}
#| message: false
#| warning: false
library(broom)
library(tidyverse)
```

## Read data

```{r read-memory}
mem_wide <- read_tsv(
  file="../data/memory.txt",
  col_types="nn")
names(mem_wide) <- tolower(names(mem_wide))
glimpse(mem_wide)
```

## Restructure the data

The memory results for gingko and placebo patients are in side-by-side columns. The data analysis in R requires that all the memory results be in a single column with an additional column that identifies which observations come from gingko or placebo patients. The pivot_longer function will accomplish this.

```{r restructure}
mem_wide |>
  pivot_longer(
#    cols=everything(),
    cols=c(
      "gingko", 
      "placebo"),
    names_to="treatment", 
    values_to="memory") |>
  filter(!is.na(memory)) -> mem_long
glimpse(mem_long)
```

## Boxplot of memory by treatment

```{r}
#| fig.height: 1.5
mem_long |>
  ggplot(aes(treatment, memory)) +
    geom_boxplot() +
    ggtitle("Graph drawn by Steve Simon on 2024-10-05") +
    xlab("Treatment group") +
    ylab("Memory score") +
    coord_flip()
```

Assuming that a positive value represents improvement, most patients showed improvement in both groups. The memory scores were slightly better in the placebo group. Both groups have similar variation and look to be roughly symmetric.

## Descriptive statistics for memory by treatment

```{r treatment-counts}
mem_long |>
  group_by(treatment) |>
  summarize(
    memory_mn=mean(memory),
    memory_sd=sd(memory),
    n=n())
```

The average memory score is slightly higher in the placebo groups. Both groups have a large amount of variability.

## Two-sample t-test

```{r t-test}
m1 <- t.test(
  memory ~ treatment, 
  data=mem_long,
  alternative="two.sided",
  var.equal=TRUE)
m1
tidy(m1) |>
  select(estimate, statistic, parameter, p.value)
tidy(m1) |>
  select(estimate, conf.low, conf.high)
m1$stderr
# augment(m1)
```