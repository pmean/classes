---
title: "Comments for MEDB 5501, Week 14"
format: 
  revealjs:
    slide-number: true
    embed-resources: true
editor: visual
---

## Artificial data

```{r}
library(tidyverse)
fn <- "../data/data-13-correlation.csv"
read_csv(file=fn) %>% 
  data.frame() %>%
  set_names(c("y", "x")) -> simple
simple[ , 2:1] %>%
  arrange(x) %>%
  print(row.names=FALSE)
```

```{r}
simple %>%
  ggplot(aes(x, y)) +
    expand_limits(x=c(0, 20), y=c(-5, 40)) -> simple_plot

draw_line <- function(a, b, points=simple$y) {
  pred <- a+b*simple$x
  res <- points - pred
  sse <- sum(res^2)
  simple_plot +
    geom_point(aes(x=simple$x, y=points)) +
    geom_segment(x=0, y=a, xend=20, yend=a+b*20) +
    geom_segment(
      x=simple$x, 
      y=points, 
      xend=simple$x, 
      yend=pred) +
    geom_label(
      x=simple$x,
      y=-3,
      label=res)
}
```

## Sum of squares regression

```{r}
pred <- 30-simple$x
draw_line(20, 0, pred)
```

## Sum of squares error

```{r}
draw_line(30, -1)

```

## Sum of squares total / corrected total

```{r}
draw_line(20, 0)
```

## Sum of squares total (uncorrected)

```{r}
pred <- rep(20, length(simple$x))
draw_line(0, 0, simple$y)
```

## ANOVA table for linear regression

\begin{matrix}
            &  SS &  df &                  MS &           F-ratio \\
 Regression & SSR &   1 &   MSR=\frac{SSR}{1} & F=\frac{MSR}{MSE} \\
 Error      & SSE & n-2 & MSE=\frac{SSE}{n-2} &                   \\
 Total      & SST & n-1 &                     &
\end{matrix}

## REVIEW: ANOVA table for oneway ANOVA

\begin{matrix}
         &  SS &  df &                    MS &           F-ratio \\
 Between & SSB & k-1 &   MSB=\frac{SSB}{k-1} & F=\frac{MSB}{MSW} \\
 Within  & SSW & n-k & MSW=\frac{SSW}{n-k-1} &                   \\
 Total   & SST & n-1 &                       &
\end{matrix}

## SPSS linear regression

![](../images/simple-regression-02.png)
![](../images/simple-regression-03.png)

## SPSS General Linear Model


![](../images/simple-regression-01.png)
![](../images/simple-regression-04.png)
