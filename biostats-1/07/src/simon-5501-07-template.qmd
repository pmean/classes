---
title: "Template for 5501-07 programming assignment"
author: "Steve Simon"
format: 
  html:
    embed-resources: true
date: 2024-09-25
---

There is a [data dictionary][dd] that provides more details about the data. The program was written by Steve Simon on 2024-09-02 and is placed in the public domain.

[dd]: https://github.com/pmean/datasets/blob/master/fev.yaml

## Libraries

The tidyverse library is the only one you need for  this program.

```{r setup}
#| message: false
#| warning: false
library(broom)
library(tidyverse)
```

## List variable names

Since the variable names are not listed in the data file itself, you need to list them here.

```{r names}
pulmonary_names <- c(
    "age",
    "fev",
    "ht",
    "sex",
    "smoke")
```

## Reading the data

Here is the code to read the data and show a glimpse. 

```{r read}
pulmonary <- read_csv(
  file="../data/fev.csv",
  col_names=pulmonary_names,
  col_types="nnncc")
glimpse(pulmonary)
```

## Descriptive statistics for age

You do not need to specify na.rm=TRUE because there are no missing values.

```{r age}
pulmonary |>
  summarize(
    age_mn=mean(age),
    age_sd=sd(age),
    age_min=min(age),
    age_max=max(age))
```

Interpretations for the descriptive statistics should be provided here.

## Descriptive statistics for ht

```{r ht}
pulmonary |>
  summarize(
    ht_mn=mean(ht),
    ht_sd=sd(ht),
    ht_min=min(ht),
    ht_max=max(ht))
```

## Descriptive statistics for fev

```{r fev}
pulmonary |>
  summarize(
    fev_mn=mean(fev),
    fev_sd=sd(fev),
    fev_min=min(fev),
    fev_max=max(fev))
```

## Correlations

Using [ , 1:3] reduces the pulmonary data frame to just the first three columns.

```{r corr}
cor(pulmonary[ , 1:3])
```

The two independent variables, age and ht, are both strongly correlated with fev (r=0.76 and 0.87). They are also strongly correlated with one another (r=0.79).

## m1: Predicting fev using age

```{r m1}
m1 <- lm(fev ~ age, data=pulmonary)
m1
```

## m2: Predicting fev using ht

```{r m2}
m2 <- lm(fev ~ ht, data=pulmonary)
m2
```

## m3: Predicting fev using age and ht

```{r m3}
m3 <- lm(fev ~ age + ht, data=pulmonary)
m3
```

## m3: Confidence intervals

```{r ci}
confint(m3)
```

## m3: Analysis of variance table

```{r anova}
anova(m3)
glance(m3)$r.squared
```

## m3: t-tests

```{r}
tidy(m3)
```

## m3: Diagnostic plots, 1

```{r diagnostic-1}
r3 <- augment(m3)
qqnorm(r3$.resid)
```

## m3: Diagnostic plots, 2

```{r diagnostic-2}
r3 |>
  ggplot(aes(.resid)) +
    geom_histogram(
      binwidth=1,
      color="black",
      fill="white") +
    xlab("Residuals from m3 regression") +
    ggtitle("Graph drawn by Steve Simon on 2024-09-25")
```

## m3: Diagnostic plots, 3

```{r diagnostic-3}
r3 |>
  ggplot(aes(.fitted, .resid)) +
    geom_point() +
    xlab("Predicted values from m3 regression") +
    ylab("Residuals from m3 regression") +
    ggtitle("Graph drawn by Steve Simon on 2024-09-25")
```

## m3: Influential data points, 1

```{r influence-1}
n <- nrow(r3)
r3 |> filter(.hat > 3*3/n)
```

## m3: Influential data points, 2

```{r influence-2}
r3 |> 
  filter(abs(.std.resid) > 3)
```

## m3: Influential data points, 3

```{r influence-3}
r3 |> 
  filter(.cooksd > 1)
```

## m3: Variance inflation factor

```{r vif}
library(car)
vif(m3)
```