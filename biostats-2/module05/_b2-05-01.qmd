---
title: "Principal components analysis"
format: 
  revealjs:
    slide-number: true
    embed-resources: true
editor: source
---

## Philosophy behind principal components, 1 of 4


-   Reduce complexity by modeling inter-relationships
-   Inter-rleationships are linear
    -   There is no dependent or outcome variable in principal components analysis

## Philosophy behind principal components, 2 of 4

-   First principal component
    -   Linear combination that accounts most variation
    -   This linear combination is the first eigenvector
    -   The amount of variation accounted for is the first eigenvalue

## Philosophy behind principal components, 3 of 4

-   Need to resolve an ambiguity
    -   $3X_1+5X_2-4X_3+7X_4-1X_5$ versus $6X_1+10X_2-8X_3+14X_4-2X_5$
    -   Solution: require sum of squared coefficients to equal 1
    -   Note: $3^2+5^2+(-4)^2+7^2+(-1)^2=100$
    -   Use $\frac{3}{10}X_1+\frac{5}{10}X_2-\frac{4}{10}X_3+\frac{7}{10}X_4-\frac{1}{10}X_5$

## Philosophy behind principal components, 4 of 4

-   Second principal component
    -   Linear combination that accounts second most variation
    -   Must be uncorrelated with first principal component
    -   This linear combination is the second eigenvector
    -   The amount of variation accounted for is the second eigenvalue
-   Third principal component defined similarly

## Covariance matrix or correlation matrix

-   Correlation matrix equivalent to standardizing
    -   Absolute requirement if differing units
-   Covariance matrix de-emphasizes low variance variables    

## How many components?

-   Percentage of variation accounted for
    -   Scree plot
-   Eigenvalues > 1
-   Researcher preference/convenience

## Communality

-   Amount of shared variation
    -   Always between 0 and 1
    -   Similar interpretation to R-squared
    -   "One of these things is not like the others"
    
## Factor score matrix

-   Linear combination coefficients
-   Needed if you score by hand
-   No obvious interpretation
-   First component is often only positive values

## Component matrix

-   Interpret as correlation matrix
    -   Rows are individual variables
    -   Columns are principal components

## Health-related quality of life, 1 of 6

```{r}
#| warnings: true 
library(yaml)
fn <- "../data/tb-qol-data-dictionary.yaml"
dd <- read_yaml(fn)
cat(as.yaml(dd["data_dictionary"]))
cat(as.yaml(dd["source"]))
cat(as.yaml(dd["description"]))
i <- 0
j <- 15
```

::: notes
Here are a few pieces of the data dictionary for a file I will be using. I won't show the entire data dictionary, as it is quite long.
:::

## Health-related quality of life, `r i/3+2` of 6

```{r}
cat(as.yaml(dd$vars[i+j]))
cat(as.yaml(dd$vars[i+j+1]))
cat(as.yaml(dd$vars[i+j+2]))
i <- i+3
```


## Health-related quality of life, `r i/3+2` of 6

```{r}
cat(as.yaml(dd$vars[i+j]))
cat(as.yaml(dd$vars[i+j+1]))
cat(as.yaml(dd$vars[i+j+2]))
i <- i+3
```

## Health-related quality of life, `r i/3+2` of 6

```{r}
cat(as.yaml(dd$vars[i+j]))
cat(as.yaml(dd$vars[i+j+1]))
cat(as.yaml(dd$vars[i+j+2]))
i <- i+3
```

## Health-related quality of life, `r i/3+2` of 6

```{r}
cat(as.yaml(dd$vars[i+j]))
cat(as.yaml(dd$vars[i+j+1]))
cat(as.yaml(dd$vars[i+j+2]))
i <- i+3
```
## Health-related quality of life, `r i/3+2` of 6

```{r}
cat(as.yaml(dd$vars[i+j]))
cat(as.yaml(dd$vars[i+j+1]))
cat(as.yaml(dd$vars[i+j+2]))
i <- i+3
```

## Correlation matrix, 1 of 3

![](images/pca-analysis-01.png)


## Correlation matrix, 2 of 3

![](images/pca-analysis-02.png)

## Correlation matrix, 3 of 3

![](images/pca-analysis-03.png)

## Communalities

![](images/pca-analysis-04.png)

## Eigenvalues

![](images/pca-analysis-05.png)

## Scree plot

![](images/pca-analysis-06.png)

## Component matrix

![](images/pca-analysis-07.png)

