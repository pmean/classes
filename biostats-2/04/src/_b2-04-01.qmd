---
title: "Indicator variables for three or more categories"
format: 
  revealjs:
    slide-number: true
    embed-resources: true
editor: source
---

## Review oneway analysis of variance

-   $H_0:\ \mu_1=\mu_2=...=\mu_k$
-   $H_1:\ \mu_i \ne \mu_j$ for some i, j
    -   Reject $H_0$ if F-ratio is large
-   Note: when k=2, use analysis of variance or t-test

::: notes
In Biostats-1, we discussed the comparison of three or more means using oneway or single factor analysis of variance. You can actually use analysis of variance when comparing only two means, but an equivalent alternative is the t-test.
:::

## Full moon data

```{r}
#| label: setup-1
#| message: false
#| warning: false

load("../data/module04.RData")
```


-   Admission rates to mental health clinic before, during, and after full moon.
-   One year of data

https://github.com/pmean/data/blob/main/files/full-moon-er-admissions.txt
https://github.com/pmean/data/blob/main/files/full-moon-er-admissions.yaml

::: notes
To illustrate oneway analysis of variance, I found a dataset on mental health clinic admissions.
:::

## Line graph of full moon data

```{r}
#| label: plot-01

plot_01
```

::: notes
Here is a lineplot. It is a useful way to display data in a two factor analysis of variance. You can see a general trend of increased admission rates during a full moon in some months, but not in others.
:::

## Alternative line graph of full moon data

```{r}
#| label: plot-02

plot_02
```

::: notes
Here is an alternative lineplot. This is somewhat similar to deciding what to place as the rows and what to place as the columns in a table of counts.

Which graph do you like better? I tend to waver between the two.
:::

## Descriptive statistics

```{r}
#| label: table-01

table_01
```

::: notes
Here are the means and standard deviations.
:::

## Analysis of variance table

```{r}
#| label: table-02

table_02
```

## Output from lm function

```{r}
#| label: table-03

table_03
```

::: notes
Here are the parameter estimates. The intercept is the estimated average rate when the first and second indicator both equal zero. This is effectively the average rate for the third group (during a full moon).

The first slope is the estimated average difference in rates when you increase the first indicator by one unit and hold the second indicator constant. This is effectively the the average rate for the first group (after a full moon) minus the average rate for the third group (during a full moon). When the days switch from during a full moon to after a full moon, the estimated average admission rate decreases by almost two patients per day.

The second slope is the estimated average difference in rates when you increase the second indicator by one unit and hold the first indicator constant. This is effectively the the average rate for the second group (before a full moon) minus the average rate for the third group (during a full moon). When the days switch from during a full moon to before a full moon, the estimated average admission rate decreases by 2.5 patients per day.
:::

## Tukey post hoc

```{r}
#| label: table-04

table_04
```


::: notes
Normally, you would not run a post hoc test after accepting the null hypothesis. If you did, you would see that every confidence interval includes the value of zero.

There are a few times (very, very few) where you accept the null hypothesis and the post hoc test shows differences between two of the groups.

There are also a few times where you reject the null hypothesis, but the post hoc test shows no differences between any of the groups. There is an explanation in both cases, but the cases are so rare that I do not want to delve further into them.
:::

