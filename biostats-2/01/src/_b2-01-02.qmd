---
title: "Interpretation of linear regression"
format: 
  revealjs:
    slide-number: true
    embed-resources: true
editor: source
execute:
  echo: false
---

## Linear regression interpretation of a straight line

-   Regression equation
    -   $Y_i=\beta_0+\beta_1 X_i+\epsilon_i$
-   The slope represents the estimated average change in Y when X increases by one unit.
-   The intercept represents the estimated average value of Y when X equals zero.
-   Terminology
    -   X is the independent or predictor variable
    -   Y is the dependent or outcome variable

::: notes

In linear regression, we use a straight linear to estimate a trend in data. We can't always draw a straight line that passes through every data point, but we can find a line that "comes close" to most of the data. This line is an estimate, and we interpret the slope and the intercept of this line as follows:

Be cautious with your interpretation of the intercept. Sometimes the value X=0 is impossible, implausible, or represents a dangerous extrapolation outside the range of the data.

:::

## Simple regression example with interpretation, 1

```{r}
#| label: 01-setup
#| echo: false
#| message: false
#| warning: false

library(broom)
library(glue)
library(tidyverse)

load("../data/module01.RData")
```

```{r}
#| label:  01-plot-bf-data

p2
```

:::notes

Here is an illustration of a linear regression model. This data is from a study of breast feeding in pre-term infants. Successful breast feeding is more difficult for a pre-term infant because the mother goes home from the birth hospital before the infant. The independent variable, X, is the mother's age. The dependent variable is the age at which the infant stopped breast feeding. The goal is to reach at least six months of breast feeding.

Notice a weak trend here. Older mother's seem to do a bit better than younger mothers, but there are some 20 year old moms who breast feed for quite a long time and some 40 year old moms who stop breast feeding early. Still, there is a tendency for older moms to breast feed longer than younger moms.

:::

## Simple regression example with interpretation, 2

```{r}
#| label:  01-plot-bf-expand

b <- coef(m1)

p2 +
  expand_limits(x=0) +
  geom_segment(
    x=0, 
    y=b[1],
    xend=16,
    yend=b[1]+16*b[2],
    linetype="dotted")
```

::: notes
Here is a modification of the graph that expands the limits of the X axis to include X=0. This graph also extends the line beyond the range of the data all the way down to X=0. I used a dotted line and a different color to emphasize that this is an extrapolation beyond the range of the data.

The graph shown below represents the relationship between mother's age and the duration of breast feeding in a research study on breast feeding in pre-term infants.

The regression coefficients are shown below. The intercept, 6, is represented the estimated average duration of breast feeding for a mother that is zero years old. This is an impossible value, so the interpretation is not useful. What is useful, is the interpretation of the slope, approximately 0.4. The estimated average duration of breast feeding increases by 0.4 weeks for every extra year in the mother's age.
:::

## Simple regression example with interpretation, 3

```{r}
#| label: 01-lm

tidy(m1)
```

:::notes
The actual values are pretty close to the rough estimates that we got from the graph.
:::

## Predicted values, 1

-   How long would you expect a 20 year old mom to breast feed?

```{r}
#| label: 01-predict

ng5 |>
  filter(mom_age==20) |>
  select(mom_age, age_stop)
```

:::notes
Easy way out is to find a 20 year old mother in the data. That is actually not such a good idea. But there are five of them, four if you are only counting non-missing values. 

In a different dataset maybe you have data on 19 and 21 year olds but no 20 year olds.

If you predict using a linear regression model, you are incorporating information from all mothers into your prediction, not just 20 year old mothers. Unless there are some major problems with the regression model, this is a much better choice.
:::

## Predicted values, 2

-   For an existing value in the data, $X_i$
    -   $\hat{Y}_i=b_0+b_1 X_i$
-   For a new value of X
    -   $\hat{Y}_{new}=b_0+b_1 X_{new}$
    -   Do not predict outside the range of X values

:::notes
To make a prediction at an existing value in the dataset, use the first formula. If you want to make a prediction at a value that is not in your dataset, use the same formula, but notice that the subscript is "new" to emphasize that this is a new value not seen before in the data. Be careful here. It is okay to make predictions inside the range of the X values. In the breast feeding example that I have been talking about, it is okay to make predictions for a mother between the ages of 16 and 44, but making predictions for a 14 year old mother or a 50 year old mother is risky. You could be making a dangerous extrapolation.
:::
    
## Why predict for a value you already have seen?

-   Future Y may differ from previous Y
-   $\hat{Y}_i$ is more precise
-   Comparison of $\hat{Y}_i$ to existing $Y_i$.

## Predicted values, 3

Predicted age_stop = 5.92 + 0.389*20 = 13.7

```{r}
#| label: 01-augment

augment(m1, 
  newdata =
    data.frame(
      mom_age=20))
```

:::notes
Here is the predicted value from R.
:::

## Residuals, 1

-   $e_i=Y_i-\hat{Y}_i$
    -   Residual = Observed - Predicted
-   Very helpful in assessing assumptions
    
:::notes
The residual is also important. It represents the deviation between what was actually observed and what was predicted.

The residual is very helpful in assessing the assumptions needed for linear regression. This is a topic I will reserve for a later module.
:::

## Residuals, 2

```{r}
#| label: 01-residual

augment(m1) |>
	filter(mom_age==20) |>
	select(
		.rownames,
		mom_age,
		age_stop,
		.fitted,
		.resid)
```
